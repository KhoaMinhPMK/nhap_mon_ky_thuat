# Äáº I Há»ŒC QUá»C GIA THÃ€NH PHá» Há»’ CHÃ MINH
# TRÆ¯á»œNG Äáº I Há»ŒC BÃCH KHOA
# KHOA KHOA Há»ŒC á»¨NG Dá»¤NG

---

# BÃO CÃO NGÃ€Y Há»˜I Ká»¸ THUáº¬T
## NiÃªn khÃ³a 2024 - 2025

---

# **Äá» tÃ i: Há»† THá»NG PHÃ‚N LOáº I DÆ¯A Háº¤U Sá»¬ Dá»¤NG CÃNH TAY ROBOT TÃCH Há»¢P THá»Š GIÃC MÃY TÃNH VÃ€ CHATBOT AI**

---

**GVHD:** ThS. Nguyá»…n ThÃ¡i Hiá»n

**Lá»›p:** L02

**NhÃ³m:** NgÅ© Lá»±c BÃ¡ch Khoa

---

**TP.HCM, 12/2024**

---

## DANH SÃCH THÃ€NH VIÃŠN

| STT | ThÃ nh viÃªn nhÃ³m | MSSV | CÃ´ng viá»‡c |
|-----|-----------------|------|-----------|
| 1 | LÃª Thá»‹ NhÃ£ My | 2412138 | LaTeX, thuyáº¿t trÃ¬nh, tÃ¬m hiá»ƒu code |
| 2 | LÃª Trung NghÄ©a | 2412263 | Ná»™i dung bÃ¡o cÃ¡o |
| 3 | DÆ°Æ¡ng Anh KhÃ´i | 2411678 | LÃ m sáº£n pháº©m, tÃ¬m hiá»ƒu code, thiáº¿t káº¿ máº¡ch |
| 4 | LÃ¢m Thanh BÃ¬nh | 2410343 | LÃ m sáº£n pháº©m, tÃ¬m hiá»ƒu code |
| 5 | Nguyá»…n VÃµ SÆ¡n TÃ¹ng | 2413879 | TÃ¬m hiá»ƒu code, lÃ m sáº£n pháº©m |
| 6 | Äáº·ng Huá»³nh Anh Báº£o | 2410220 | TÃ¬m hiá»ƒu code, PowerPoint |

---

## Má»¤C Lá»¤C

1. [NHáº¬N XÃ‰T Cá»¦A GIÃO VIÃŠN](#nháº­n-xÃ©t-cá»§a-giÃ¡o-viÃªn)
2. [DANH SÃCH HÃŒNH Váº¼](#danh-sÃ¡ch-hÃ¬nh-váº½)
3. [Lá»œI GIá»šI THIá»†U](#lá»i-giá»›i-thiá»‡u)
4. [Lá»œI Cáº¢M Æ N](#lá»i-cáº£m-Æ¡n)
5. [CHÆ¯Æ NG 1: Má» Äáº¦U](#chÆ°Æ¡ng-1-má»Ÿ-Ä‘áº§u)
   - 1.1 LÃ­ do chá»n Ä‘á» tÃ i
   - 1.2 Má»¥c tiÃªu
   - 1.3 Pháº¡m vi nghiÃªn cá»©u
6. [CHÆ¯Æ NG 2: CÆ  Sá» LÃ THUYáº¾T](#chÆ°Æ¡ng-2-cÆ¡-sá»Ÿ-lÃ½-thuyáº¿t)
   - 2.1 CÃ¡nh tay robot cÃ´ng nghiá»‡p
   - 2.2 Thá»‹ giÃ¡c mÃ¡y tÃ­nh (Computer Vision)
   - 2.3 Há»c mÃ¡y vÃ  máº¡ng nÆ¡-ron tÃ­ch cháº­p (CNN)
   - 2.4 Láº­p trÃ¬nh kÃ©o tháº£ Blockly
   - 2.5 Chatbot AI trong nÃ´ng nghiá»‡p
7. [CHÆ¯Æ NG 3: THIáº¾T Káº¾ Há»† THá»NG](#chÆ°Æ¡ng-3-thiáº¿t-káº¿-há»‡-thá»‘ng)
   - 3.1 Kiáº¿n trÃºc tá»•ng quan
   - 3.2 Thiáº¿t káº¿ pháº§n cá»©ng
   - 3.3 Thiáº¿t káº¿ pháº§n má»m
   - 3.4 Giao diá»‡n ngÆ°á»i dÃ¹ng
8. [CHÆ¯Æ NG 4: TRIá»‚N KHAI VÃ€ THá»°C HIá»†N](#chÆ°Æ¡ng-4-triá»ƒn-khai-vÃ -thá»±c-hiá»‡n)
   - 4.1 Pháº§n cá»©ng Arduino vÃ  CNC Shield
   - 4.2 Backend Flask Server
   - 4.3 Machine Learning Model
   - 4.4 Mobile App vá»›i Chatbot AI
9. [CHÆ¯Æ NG 5: Káº¾T QUáº¢ VÃ€ ÄÃNH GIÃ](#chÆ°Æ¡ng-5-káº¿t-quáº£-vÃ -Ä‘Ã¡nh-giÃ¡)
   - 5.1 Káº¿t quáº£ thá»­ nghiá»‡m
   - 5.2 ÄÃ¡nh giÃ¡ hiá»‡u nÄƒng
   - 5.3 Æ¯u Ä‘iá»ƒm vÃ  háº¡n cháº¿
10. [CHÆ¯Æ NG 6: Káº¾T LUáº¬N VÃ€ HÆ¯á»šNG PHÃT TRIá»‚N](#chÆ°Æ¡ng-6-káº¿t-luáº­n-vÃ -hÆ°á»›ng-phÃ¡t-triá»ƒn)
11. [TÃ€I LIá»†U THAM KHáº¢O](#tÃ i-liá»‡u-tham-kháº£o)
12. [PHá»¤ Lá»¤C](#phá»¥-lá»¥c)

---

## NHáº¬N XÃ‰T Cá»¦A GIÃO VIÃŠN

_________________________________________________________________________

_________________________________________________________________________

_________________________________________________________________________

_________________________________________________________________________

_________________________________________________________________________

_________________________________________________________________________

_________________________________________________________________________

_________________________________________________________________________

_________________________________________________________________________

_________________________________________________________________________

---

## DANH SÃCH HÃŒNH Váº¼

| STT | TÃªn hÃ¬nh | Trang |
|-----|----------|-------|
| HÃ¬nh 2.1 | Cáº¥u trÃºc cÃ¡nh tay robot cÃ´ng nghiá»‡p | |
| HÃ¬nh 2.2 | Quy trÃ¬nh xá»­ lÃ½ áº£nh trong Computer Vision | |
| HÃ¬nh 2.3 | Kiáº¿n trÃºc máº¡ng nÆ¡-ron tÃ­ch cháº­p (CNN) | |
| HÃ¬nh 2.4 | Giao diá»‡n láº­p trÃ¬nh Blockly | |
| HÃ¬nh 3.1 | Kiáº¿n trÃºc tá»•ng quan há»‡ thá»‘ng PDscript | |
| HÃ¬nh 3.2 | SÆ¡ Ä‘á»“ káº¿t ná»‘i pháº§n cá»©ng | |
| HÃ¬nh 3.3 | SÆ¡ Ä‘á»“ luá»“ng hoáº¡t Ä‘á»™ng | |
| HÃ¬nh 4.1 | Giao diá»‡n Web vá»›i Blockly Workspace | |
| HÃ¬nh 4.2 | Giao diá»‡n Mobile App | |
| HÃ¬nh 5.1 | Káº¿t quáº£ phÃ¢n loáº¡i dÆ°a háº¥u | |

---

## Lá»œI GIá»šI THIá»†U

Trong ká»· nguyÃªn sá»‘, tá»± Ä‘á»™ng hÃ³a khÃ´ng chá»‰ giá»›i háº¡n á»Ÿ nhÃ  mÃ¡y mÃ  Ä‘ang trá»Ÿ thÃ nh chÃ¬a khÃ³a vÃ ng cho nÃ´ng nghiá»‡p. Thá»±c táº¿ Ä‘Ã¡ng buá»“n lÃ  dÆ°a háº¥u Viá»‡t Nam thÆ°á»ng xuyÃªn chá»‹u cáº£nh giÃ¡ tháº¥p hoáº·c bá»‹ Ã©p giÃ¡ khi xuáº¥t kháº©u do khÃ¢u phÃ¢n loáº¡i thá»§ cÃ´ng thiáº¿u sá»± Ä‘á»“ng bá»™ vá» cháº¥t lÆ°á»£ng. So vá»›i cÃ¡c há»‡ thá»‘ng phÃ¢n loáº¡i báº±ng bÄƒng chuyá»n truyá»n thá»‘ng thÆ°á»ng cá»“ng ká»nh vÃ  khÃ³ tÃ¹y biáº¿n, cÃ¡nh tay robot ná»•i lÃªn nhÆ° má»™t giáº£i phÃ¡p thay tháº¿ Æ°u viá»‡t nhá» sá»± nhá» gá»n, linh hoáº¡t vÃ  Ä‘á»™ chÃ­nh xÃ¡c cao. Tuy nhiÃªn, rÃ o cáº£n lá»›n nháº¥t Ä‘á»ƒ Ä‘Æ°a cÃ´ng nghá»‡ nÃ y vÃ o thá»±c tiá»…n chÃ­nh lÃ  sá»± phá»©c táº¡p trong váº­n hÃ nh, Ä‘Ã²i há»i ngÆ°á»i nÃ´ng dÃ¢n pháº£i cÃ³ kiáº¿n thá»©c chuyÃªn sÃ¢u vá» láº­p trÃ¬nh vÃ  tá»± Ä‘á»™ng hÃ³a.

Giáº£i quyáº¿t bÃ i toÃ¡n nÃ y, nhÃ³m thá»±c hiá»‡n Ä‘á» tÃ i: **"Há»‡ thá»‘ng phÃ¢n loáº¡i dÆ°a háº¥u sá»­ dá»¥ng cÃ¡nh tay robot tÃ­ch há»£p Thá»‹ giÃ¡c mÃ¡y tÃ­nh vÃ  Chatbot AI"**. Há»‡ thá»‘ng sá»­ dá»¥ng camera thÃ´ng minh Ä‘á»ƒ nháº­n diá»‡n, phÃ¢n loáº¡i dÆ°a chuáº©n xÃ¡c, Ä‘áº£m báº£o tiÃªu chuáº©n xuáº¥t kháº©u. Äáº·c biá»‡t, viá»‡c tÃ­ch há»£p Chatbot AI giÃºp chuyá»ƒn Ä‘á»•i cÃ¡c sá»‘ liá»‡u bÃ¡o cÃ¡o khÃ´ khan thÃ nh ngÃ´n ngá»¯ tá»± nhiÃªn, dá»… hiá»ƒu, giÃºp ngÆ°á»i dÃ¹ng phá»• thÃ´ng quáº£n lÃ½ hiá»‡u quáº£ mÃ  khÃ´ng cáº§n am hiá»ƒu ká»¹ thuáº­t.

Qua Ä‘Ã³, nhÃ³m mong muá»‘n mang Ä‘áº¿n má»™t giáº£i phÃ¡p thá»±c tiá»…n, vá»«a nÃ¢ng cao giÃ¡ trá»‹ kinh táº¿ cho dÆ°a háº¥u Viá»‡t, vá»«a thÃ¢n thiá»‡n vá»›i ngÆ°á»i nÃ´ng dÃ¢n. ChÃºng em ráº¥t mong nháº­n Ä‘Æ°á»£c sá»± gÃ³p Ã½ tá»« quÃ½ tháº§y cÃ´ vÃ  cÃ¡c báº¡n.

---

## Lá»œI Cáº¢M Æ N

LÃ  má»™t táº­p thá»ƒ sinh viÃªn thuá»™c TrÆ°á»ng Äáº¡i há»c BÃ¡ch Khoa TP.HCM, mang trong mÃ¬nh niá»m Ä‘am mÃª vÃ  khÃ¡t vá»ng khÃ¡m phÃ¡ lÄ©nh vá»±c tá»± Ä‘á»™ng hÃ³a, chÃºng em vÃ´ cÃ¹ng biáº¿t Æ¡n khi Ä‘Æ°á»£c Tháº§y Nguyá»…n ThÃ¡i Hiá»n trao cÆ¡ há»™i thá»±c hiá»‡n Ä‘á» tÃ i vá»›i chá»§ Ä‘á» "Há»‡ thá»‘ng phÃ¢n loáº¡i dÆ°a háº¥u sá»­ dá»¥ng cÃ¡nh tay robot tÃ­ch há»£p Thá»‹ giÃ¡c mÃ¡y tÃ­nh vÃ  Chatbot AI."

ÄÃ¢y khÃ´ng chá»‰ lÃ  cÆ¡ há»™i Ä‘á»ƒ chÃºng em tiáº¿p cáº­n vÃ  hiá»ƒu rÃµ hÆ¡n vá» má»™t trong nhá»¯ng cÃ´ng nghá»‡ tiÃªn tiáº¿n cá»§a thá»i Ä‘áº¡i mÃ  cÃ²n giÃºp chÃºng em rÃ¨n luyá»‡n ká»¹ nÄƒng lÃ m viá»‡c nhÃ³m, tÆ° duy logic vÃ  kháº£ nÄƒng nghiÃªn cá»©u khoa há»c.

Trong quÃ¡ trÃ¬nh thá»±c hiá»‡n, chÃºng em khÃ´ng trÃ¡nh khá»i nhá»¯ng thiáº¿u sÃ³t, do Ä‘Ã¢y lÃ  láº§n Ä‘áº§u tiÃªn chÃºng em tiáº¿p cáº­n chuyÃªn sÃ¢u vá» lÄ©nh vá»±c nÃ y cÅ©ng nhÆ° lÃ m viá»‡c trong mÃ´i trÆ°á»ng há»c táº­p Ä‘Ã²i há»i tÃ­nh chuyÃªn mÃ´n cao. VÃ¬ váº­y, chÃºng em ráº¥t mong nháº­n Ä‘Æ°á»£c nhá»¯ng lá»i gÃ³p Ã½ chÃ¢n thÃ nh tá»« Tháº§y Ä‘á»ƒ bÃ i bÃ¡o cÃ¡o Ä‘Æ°á»£c hoÃ n thiá»‡n hÆ¡n, Ä‘á»“ng thá»i giÃºp chÃºng em rÃºt ra nhá»¯ng bÃ i há»c giÃ¡ trá»‹ cho hÃ nh trÃ¬nh há»c táº­p vÃ  nghiÃªn cá»©u sau nÃ y.

ChÃºng em xin chÃ¢n thÃ nh cáº£m Æ¡n sá»± hÆ°á»›ng dáº«n táº­n tÃ¬nh vÃ  nhá»¯ng há»— trá»£ quÃ½ bÃ¡u tá»« Tháº§y. Nhá»¯ng chia sáº» vÃ  gÃ³p Ã½ cá»§a Tháº§y sáº½ lÃ  hÃ nh trang quÃ½ giÃ¡ giÃºp chÃºng em ngÃ y cÃ ng trÆ°á»Ÿng thÃ nh hÆ¡n trÃªn con Ä‘Æ°á»ng chinh phá»¥c tri thá»©c vÃ  phÃ¡t triá»ƒn báº£n thÃ¢n.

**NhÃ³m sinh viÃªn thá»±c hiá»‡n**

---

## CHÆ¯Æ NG 1: Má» Äáº¦U

### 1.1 LÃ­ do chá»n Ä‘á» tÃ i

NguyÃªn nhÃ¢n cá»‘t lÃµi khiáº¿n dÆ°a háº¥u Viá»‡t Nam thÆ°á»ng xuyÃªn bá»‹ Ã©p giÃ¡ khi xuáº¥t kháº©u náº±m á»Ÿ sá»± thiáº¿u Ä‘á»“ng nháº¥t vá» cháº¥t lÆ°á»£ng, há»‡ quáº£ cá»§a viá»‡c phá»¥ thuá»™c vÃ o phÃ¢n loáº¡i thá»§ cÃ´ng. Äá»ƒ kháº¯c phá»¥c, cÃ¡c dÃ¢y chuyá»n bÄƒng táº£i cÃ´ng nghiá»‡p Ä‘Ã£ ra Ä‘á»i, tuy nhiÃªn giáº£i phÃ¡p nÃ y láº¡i quÃ¡ cá»“ng ká»nh vÃ  Ä‘áº¯t Ä‘á», khÃ´ng phÃ¹ há»£p vá»›i Ä‘áº·c thÃ¹ sáº£n xuáº¥t nhá» láº» cá»§a nÃ´ng nghiá»‡p trong nÆ°á»›c.

Trong bá»‘i cáº£nh Ä‘Ã³, cÃ¡nh tay robot ná»•i lÃªn nhÆ° má»™t giáº£i phÃ¡p thay tháº¿ tá»‘i Æ°u nhá» sá»± linh hoáº¡t vÃ  chi phÃ­ Ä‘áº§u tÆ° há»£p lÃ½. Tháº¿ nhÆ°ng, má»™t nghá»‹ch lÃ½ má»›i láº¡i náº£y sinh: **cÃ´ng nghá»‡ cÃ ng hiá»‡n Ä‘áº¡i thÃ¬ quy trÃ¬nh váº­n hÃ nh cÃ ng phá»©c táº¡p**, táº¡o ra rÃ o cáº£n vÃ´ hÃ¬nh ngÄƒn cáº£n ngÆ°á»i nÃ´ng dÃ¢n tiáº¿p cáº­n vÃ  lÃ m chá»§ ká»¹ thuáº­t.

Äá»ƒ giáº£i quyáº¿t mÃ¢u thuáº«n giá»¯a nhu cáº§u tá»± Ä‘á»™ng hÃ³a vÃ  kháº£ nÄƒng váº­n hÃ nh, nhÃ³m quyáº¿t Ä‘á»‹nh thá»±c hiá»‡n Ä‘á» tÃ i vá»›i sá»± káº¿t há»£p cÃ´ng nghá»‡ hoÃ n toÃ n má»›i:
- **Thá»‹ giÃ¡c mÃ¡y tÃ­nh (Computer Vision):** Chuáº©n hÃ³a cháº¥t lÆ°á»£ng dÆ°a xuáº¥t kháº©u chÃ­nh xÃ¡c hÆ¡n máº¯t ngÆ°á»i
- **Láº­p trÃ¬nh kÃ©o tháº£ Blockly:** Thay tháº¿ cÃ¡c báº£ng Ä‘iá»u khiá»ƒn phá»©c táº¡p báº±ng giao diá»‡n trá»±c quan
- **Chatbot AI:** "BÃ¬nh dÃ¢n hÃ³a" cÃ´ng nghá»‡, giÃºp báº¥t ká»³ ai cÅ©ng cÃ³ thá»ƒ váº­n hÃ nh há»‡ thá»‘ng hiá»‡u quáº£

### 1.2 Má»¥c tiÃªu

**Má»¥c tiÃªu ká»¹ thuáº­t:**
- XÃ¢y dá»±ng thÃ nh cÃ´ng há»‡ thá»‘ng cÃ¡nh tay robot 3 trá»¥c (CNC) cÃ³ kháº£ nÄƒng phÃ¢n loáº¡i dÆ°a háº¥u tá»± Ä‘á»™ng vá»›i Ä‘á»™ chÃ­nh xÃ¡c cao
- á»¨ng dá»¥ng thuáº­t toÃ¡n xá»­ lÃ½ áº£nh vÃ  cÃ´ng nghá»‡ Thá»‹ giÃ¡c mÃ¡y tÃ­nh Ä‘á»ƒ:
  - Nháº­n diá»‡n cháº¥t lÆ°á»£ng bá» máº·t
  - Äo Ä‘áº¡c kÃ­ch thÆ°á»›c
  - PhÃ¡t hiá»‡n cÃ¡c khuyáº¿t táº­t vá»
- Äáº£m báº£o sá»± Ä‘á»“ng Ä‘á»u tuyá»‡t Ä‘á»‘i Ä‘Ã¡p á»©ng cÃ¡c tiÃªu chuáº©n kháº¯t khe cá»§a thá»‹ trÆ°á»ng xuáº¥t kháº©u

**Má»¥c tiÃªu vá» tÆ°Æ¡ng tÃ¡c ngÆ°á»i-mÃ¡y:**
- PhÃ¡t triá»ƒn phÆ°Æ¡ng thá»©c tÆ°Æ¡ng tÃ¡c thÃ¢n thiá»‡n thÃ´ng qua giao diá»‡n Blockly
- XÃ¢y dá»±ng "trá»£ lÃ½ áº£o" Chatbot AI cÃ³ kháº£ nÄƒng:
  - Tá»•ng há»£p dá»¯ liá»‡u sáº£n lÆ°á»£ng
  - Gá»­i bÃ¡o cÃ¡o cháº¥t lÆ°á»£ng báº±ng ngÃ´n ngá»¯ tá»± nhiÃªn
- XÃ³a bá» rÃ o cáº£n cÃ´ng nghá»‡, Ä‘á»ƒ ngÆ°á»i dÃ¹ng phá»• thÃ´ng cÅ©ng cÃ³ thá»ƒ váº­n hÃ nh dá»… dÃ ng

**Má»¥c tiÃªu lan tá»a:**
- Truyá»n táº£i thÃ´ng Ä‘iá»‡p vá» "NÃ´ng nghiá»‡p thÃ´ng minh" hiá»‡n Ä‘áº¡i nhÆ°ng gáº§n gÅ©i
- Chá»©ng minh tÃ­nh kháº£ thi cá»§a viá»‡c á»©ng dá»¥ng AI vÃ o giáº£i quyáº¿t bÃ i toÃ¡n thá»±c tiá»…n cá»§a nÃ´ng sáº£n Viá»‡t Nam

### 1.3 Pháº¡m vi nghiÃªn cá»©u

**Pháº¡m vi Ä‘á» tÃ i:**
- PhÃ¢n loáº¡i dÆ°a háº¥u thÃ nh 3 loáº¡i: Premium (ThÆ°á»£ng háº¡ng), Second-grade (BÃ¬nh thÆ°á»ng), Defective (Lá»—i)
- Há»‡ thá»‘ng hoáº¡t Ä‘á»™ng trong mÃ´i trÆ°á»ng trong nhÃ  vá»›i Ä‘iá»u kiá»‡n Ã¡nh sÃ¡ng á»•n Ä‘á»‹nh
- Khá»‘i lÆ°á»£ng xá»­ lÃ½ phÃ¹ há»£p vá»›i quy mÃ´ nÃ´ng há»™ nhá» vÃ  vá»«a

**CÃ´ng nghá»‡ sá»­ dá»¥ng:**
- Pháº§n cá»©ng: Arduino Uno + CNC Shield V3 + Stepper Motor
- Pháº§n má»m: Python Flask, TensorFlow, React Native
- Giao tiáº¿p: WebSocket, Serial COM, REST API

---

## CHÆ¯Æ NG 2: CÆ  Sá» LÃ THUYáº¾T

### 2.1 CÃ¡nh tay robot cÃ´ng nghiá»‡p

#### 2.1.1 Äá»‹nh nghÄ©a

CÃ¡nh tay robot cÃ´ng nghiá»‡p lÃ  má»™t thiáº¿t bá»‹ hiá»‡n Ä‘áº¡i Ä‘Æ°á»£c láº­p trÃ¬nh Ä‘á»ƒ mÃ´ phá»ng cÃ¡c chuyá»ƒn Ä‘á»™ng cá»§a cÃ¡nh tay con ngÆ°á»i. Vá»›i thiáº¿t káº¿ bao gá»“m cÃ¡c khá»›p linh hoáº¡t di chuyá»ƒn trÃªn trá»¥c dá»c vÃ  kháº£ nÄƒng xoay theo nhiá»u hÆ°á»›ng khÃ¡c nhau, cÃ¡nh tay robot cÃ³ thá»ƒ hoáº¡t Ä‘á»™ng chÃ­nh xÃ¡c vÃ  hiá»‡u quáº£ trong nhiá»u mÃ´i trÆ°á»ng lÃ m viá»‡c.

#### 2.1.2 Cáº¥u táº¡o

Cáº¥u táº¡o cá»§a cÃ¡nh tay robot vá» cÆ¡ báº£n bao gá»“m cÃ¡c bá»™ pháº­n sau:

**Tay mÃ¡y (Manipulator):**
- Bao gá»“m khÃ¢u vÃ  khá»›p Ä‘Æ°á»£c cáº¥u táº¡o mÃ´ phá»ng vá»›i kháº£ nÄƒng chuyá»ƒn Ä‘á»™ng cÆ¡ báº£n
- Bao gá»“m cá»• tay cá»­ Ä‘á»™ng dá»… dÃ ng, bÃ n tay thá»±c hiá»‡n nhá»¯ng thao tÃ¡c vÃ  trá»±c tiáº¿p hoÃ n thÃ nh cÃ´ng viá»‡c

**Há»‡ thá»‘ng Ä‘iá»u khiá»ƒn:**
- Äáº£m báº£o nhiá»‡m vá»¥ tiáº¿n hÃ nh nhá»¯ng thao tÃ¡c má»—i khi cÃ³ tÃ­n hiá»‡u
- Váº­n hÃ nh tá»« Ä‘Æ¡n giáº£n Ä‘áº¿n phá»©c táº¡p nhÆ° tÃ­nh toÃ¡n Ä‘á»™ng há»c, ná»™i suy, xá»­ lÃ½ lá»—i, thiáº¿t láº­p quá»¹ Ä‘áº¡o

**Pháº§n má»m quáº£n lÃ½:**
- LÃ  mÃ´i trÆ°á»ng láº­p trÃ¬nh vÃ  phÆ°Æ¡ng tiá»‡n Ä‘á»ƒ ngÆ°á»i váº­n hÃ nh ra lá»‡nh cho robot
- Cáº§n cÃ³ ngÃ´n ngá»¯ láº­p trÃ¬nh thÃ­ch há»£p, thÃ¢n thiá»‡n vÃ  dá»… dÃ ng sá»­ dá»¥ng

#### 2.1.3 NguyÃªn lÃ½ hoáº¡t Ä‘á»™ng

- CÃ´ng viá»‡c cá»§a cÃ¡nh tay chá»§ yáº¿u lÃ  di chuyá»ƒn sáº£n pháº©m, linh kiá»‡n tá»« nÆ¡i nÃ y sang nÆ¡i khÃ¡c
- Bao gá»“m: nháº·t, nÃ¢ng lÃªn, Ä‘áº·t xuá»‘ng, thÃ¡o ra, hÃ n hoáº·c táº¥t cáº£ cÃ´ng viá»‡c Ä‘Ã³
- Robot Ä‘Æ°á»£c láº­p trÃ¬nh tá»± Ä‘á»™ng Ä‘á»ƒ hoÃ n thÃ nh cÃ´ng viá»‡c mÃ  ngÆ°á»i dÃ¹ng mong muá»‘n

**Hai yáº¿u tá»‘ quan trá»ng trong há»‡ thá»‘ng cÃ¡nh tay robot:**
1. **Bá»™ Ä‘iá»u khiá»ƒn:** Äiá»u khiá»ƒn hoáº¡t Ä‘á»™ng cá»§a robot
2. **Teach Pendant:** GiÃºp láº­p trÃ¬nh cho robot

#### 2.1.4 á»¨ng dá»¥ng trong nÃ´ng nghiá»‡p

Trong ngá»¯ cáº£nh nÃ´ng nghiá»‡p, cÃ¡nh tay robot Ä‘Æ°á»£c á»©ng dá»¥ng cho:
- **Gáº¯p, tháº£ sáº£n pháº©m:** Trang bá»‹ há»‡ thá»‘ng nháº­n diá»‡n Ä‘á»ƒ xÃ¡c Ä‘á»‹nh Ä‘á»“ váº­t, tá»± Ä‘á»™ng nháº·t vÃ  Ä‘áº·t theo vá»‹ trÃ­ Ä‘á»‹nh sáºµn
- **Kiá»ƒm tra cháº¥t lÆ°á»£ng:** Trang bá»‹ cáº£m biáº¿n, há»‡ thá»‘ng nháº­n diá»‡n, camera vÃ  AI Ä‘á»ƒ xÃ¡c Ä‘á»‹nh cÃ¡c bá»™ pháº­n bá»‹ lá»—i
- **PhÃ¢n loáº¡i sáº£n pháº©m:** Tá»± Ä‘á»™ng phÃ¢n loáº¡i dá»±a trÃªn Ä‘áº·c Ä‘iá»ƒm nháº­n diá»‡n Ä‘Æ°á»£c

### 2.2 Thá»‹ giÃ¡c mÃ¡y tÃ­nh (Computer Vision)

#### 2.2.1 KhÃ¡i niá»‡m

Thá»‹ giÃ¡c mÃ¡y tÃ­nh lÃ  má»™t lÄ©nh vá»±c cá»§a trÃ­ tuá»‡ nhÃ¢n táº¡o cho phÃ©p mÃ¡y tÃ­nh "nhÃ¬n" vÃ  "hiá»ƒu" hÃ¬nh áº£nh nhÆ° con ngÆ°á»i. CÃ´ng nghá»‡ nÃ y sá»­ dá»¥ng cÃ¡c thuáº­t toÃ¡n Ä‘á»ƒ:
- Thu nháº­n hÃ¬nh áº£nh tá»« camera
- PhÃ¢n tÃ­ch vÃ  xá»­ lÃ½ hÃ¬nh áº£nh
- TrÃ­ch xuáº¥t thÃ´ng tin há»¯u Ã­ch
- ÄÆ°a ra quyáº¿t Ä‘á»‹nh dá»±a trÃªn dá»¯ liá»‡u hÃ¬nh áº£nh

#### 2.2.2 á»¨ng dá»¥ng trong phÃ¢n loáº¡i nÃ´ng sáº£n

Theo nghiÃªn cá»©u cá»§a RSIP Vision, robot phÃ¢n loáº¡i vÃ  phÃ¢n cáº¥p (sorting and grading robots) sá»­ dá»¥ng camera gáº¯n trÃªn cÃ¡nh tay hoáº¡t Ä‘á»™ng phÃ­a trÃªn bÄƒng chuyá»n. Nhá» camera, chÃºng cÃ³ thá»ƒ phÃ¢n loáº¡i trÃ¡i cÃ¢y nhanh chÃ³ng vÃ  chÃ­nh xÃ¡c. CÃ¡c thuáº­t toÃ¡n deep learning cÃ³ kháº£ nÄƒng:
- Nháº­n diá»‡n khuyáº¿t táº­t tá»« má»i gÃ³c Ä‘á»™
- Xá»­ lÃ½ sá»± biáº¿n Ä‘á»•i lá»›n vá» mÃ u sáº¯c vÃ  hÃ¬nh dáº¡ng
- Thá»±c hiá»‡n object detection Ä‘á»ƒ Ä‘á»‹nh vá»‹ trÃ¡i cÃ¢y
- PhÃ¢n loáº¡i cháº¥t lÆ°á»£ng sau khi Ä‘á»‹nh vá»‹

### 2.3 Há»c mÃ¡y vÃ  máº¡ng nÆ¡-ron tÃ­ch cháº­p (CNN)

#### 2.3.1 Máº¡ng nÆ¡-ron tÃ­ch cháº­p (CNN)

CNN (Convolutional Neural Network) lÃ  kiáº¿n trÃºc máº¡ng nÆ¡-ron Ä‘Æ°á»£c thiáº¿t káº¿ Ä‘áº·c biá»‡t cho cÃ¡c tÃ¡c vá»¥ phÃ¢n loáº¡i hÃ¬nh áº£nh. CNN bao gá»“m cÃ¡c thÃ nh pháº§n chÃ­nh:

**Lá»›p tÃ­ch cháº­p (Convolutional Layer):**
- TrÃ­ch xuáº¥t cÃ¡c Ä‘áº·c trÆ°ng tá»« hÃ¬nh áº£nh Ä‘áº§u vÃ o
- Sá»­ dá»¥ng cÃ¡c bá»™ lá»c (filters) Ä‘á»ƒ phÃ¡t hiá»‡n cáº¡nh, gÃ³c, texture

**Lá»›p pooling:**
- Giáº£m kÃ­ch thÆ°á»›c dá»¯ liá»‡u
- Giá»¯ láº¡i cÃ¡c Ä‘áº·c trÆ°ng quan trá»ng nháº¥t

**Lá»›p fully connected:**
- Káº¿t há»£p cÃ¡c Ä‘áº·c trÆ°ng Ä‘á»ƒ Ä‘Æ°a ra dá»± Ä‘oÃ¡n cuá»‘i cÃ¹ng
- PhÃ¢n loáº¡i hÃ¬nh áº£nh vÃ o cÃ¡c lá»›p Ä‘á»‹nh sáºµn

#### 2.3.2 á»¨ng dá»¥ng trong phÃ¢n loáº¡i trÃ¡i cÃ¢y

Theo nghiÃªn cá»©u Ä‘Æ°á»£c cÃ´ng bá»‘ nÄƒm 2024 (Rybacki et al.), CNN Ä‘Ã£ Ä‘Æ°á»£c sá»­ dá»¥ng thÃ nh cÃ´ng Ä‘á»ƒ phÃ¡t triá»ƒn mÃ´ hÃ¬nh phÃ¢n loáº¡i tá»± Ä‘á»™ng cho nhiá»u loáº¡i trÃ¡i cÃ¢y. Quy trÃ¬nh bao gá»“m:
1. Thu tháº­p bá»™ dá»¯ liá»‡u hÃ¬nh áº£nh Ä‘a dáº¡ng
2. Huáº¥n luyá»‡n máº¡ng nÆ¡-ron Ä‘á»ƒ há»c vÃ  trÃ­ch xuáº¥t Ä‘áº·c trÆ°ng
3. Tinh chá»‰nh vÃ  xÃ¡c thá»±c mÃ´ hÃ¬nh
4. Triá»ƒn khai cho phÃ¢n loáº¡i thá»i gian thá»±c

### 2.4 Láº­p trÃ¬nh kÃ©o tháº£ Blockly

#### 2.4.1 Giá»›i thiá»‡u Blockly

Blockly lÃ  má»™t thÆ° viá»‡n JavaScript mÃ£ nguá»“n má»Ÿ do Google phÃ¡t triá»ƒn, cho phÃ©p táº¡o giao diá»‡n láº­p trÃ¬nh kÃ©o tháº£ (visual programming). Äáº·c Ä‘iá»ƒm:
- **Trá»±c quan:** CÃ¡c lá»‡nh Ä‘Æ°á»£c biá»ƒu diá»…n báº±ng cÃ¡c khá»‘i mÃ u sáº¯c cÃ³ thá»ƒ ghÃ©p ná»‘i
- **Dá»… sá»­ dá»¥ng:** KhÃ´ng yÃªu cáº§u kiáº¿n thá»©c láº­p trÃ¬nh truyá»n thá»‘ng
- **Linh hoáº¡t:** CÃ³ thá»ƒ tÃ¹y chá»‰nh Ä‘á»ƒ táº¡o cÃ¡c khá»‘i lá»‡nh chuyÃªn biá»‡t

#### 2.4.2 á»¨ng dá»¥ng trong Ä‘iá»u khiá»ƒn robot

Blockly Ä‘Ã£ trá»Ÿ thÃ nh ná»n táº£ng cho nhiá»u á»©ng dá»¥ng láº­p trÃ¬nh robot, bao gá»“m:
- mBot vÃ  cÃ¡c bá»™ kit robot giÃ¡o dá»¥c
- Dash & Dot robots
- CÃ¡c há»‡ thá»‘ng tá»± Ä‘á»™ng hÃ³a trong cÃ´ng nghiá»‡p

Æ¯u Ä‘iá»ƒm khi Ã¡p dá»¥ng cho há»‡ thá»‘ng phÃ¢n loáº¡i:
- NgÆ°á»i dÃ¹ng khÃ´ng cáº§n biáº¿t láº­p trÃ¬nh
- Táº¡o ká»‹ch báº£n phÃ¢n loáº¡i nhanh chÃ³ng
- Dá»… dÃ ng chá»‰nh sá»­a vÃ  thá»­ nghiá»‡m

### 2.5 Chatbot AI trong nÃ´ng nghiá»‡p

#### 2.5.1 Vai trÃ² cá»§a Chatbot AI

Chatbot AI trong nÃ´ng nghiá»‡p Ä‘Ã³ng vai trÃ² nhÆ° má»™t trá»£ lÃ½ thÃ´ng minh, giÃºp:
- **ÄÆ¡n giáº£n hÃ³a giao tiáº¿p:** Chuyá»ƒn Ä‘á»•i dá»¯ liá»‡u ká»¹ thuáº­t thÃ nh ngÃ´n ngá»¯ tá»± nhiÃªn
- **Há»— trá»£ quyáº¿t Ä‘á»‹nh:** Cung cáº¥p phÃ¢n tÃ­ch vÃ  gá»£i Ã½ hÃ nh Ä‘á»™ng
- **GiÃ¡m sÃ¡t tá»« xa:** Cáº­p nháº­t tÃ¬nh tráº¡ng há»‡ thá»‘ng real-time

#### 2.5.2 CÃ´ng nghá»‡ sá»­ dá»¥ng

Há»‡ thá»‘ng Chatbot AI trong Ä‘á» tÃ i sá»­ dá»¥ng:
- **LLM (Large Language Model):** Groq API vá»›i model GPT
- **Context-aware:** Tá»± Ä‘á»™ng thu tháº­p dá»¯ liá»‡u tá»“n kho, cáº£nh bÃ¡o, thá»‘ng kÃª
- **Markdown rendering:** Hiá»ƒn thá»‹ káº¿t quáº£ Ä‘áº¹p máº¯t, dá»… Ä‘á»c

---

## CHÆ¯Æ NG 3: THIáº¾T Káº¾ Há»† THá»NG

### 3.1 Kiáº¿n trÃºc tá»•ng quan

Há»‡ thá»‘ng PDscript (Product Detection & Script) Ä‘Æ°á»£c thiáº¿t káº¿ theo mÃ´ hÃ¬nh client-server vá»›i cÃ¡c thÃ nh pháº§n chÃ­nh:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         PDscript System                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚  â”‚   Web UI    â”‚    â”‚ Mobile App  â”‚    â”‚  Arduino    â”‚              â”‚
â”‚  â”‚  (Blockly)  â”‚â—„â”€â”€â–ºâ”‚   (React    â”‚    â”‚   (CNC)     â”‚              â”‚
â”‚  â”‚             â”‚    â”‚   Native)   â”‚    â”‚             â”‚              â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜              â”‚
â”‚         â”‚                  â”‚                  â”‚                      â”‚
â”‚         â”‚ WebSocket        â”‚ REST API         â”‚ Serial COM           â”‚
â”‚         â–¼                  â–¼                  â–¼                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚  â”‚              Flask Server (Python)                   â”‚            â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚            â”‚
â”‚  â”‚  â”‚ Serial  â”‚ â”‚ Camera  â”‚ â”‚   ML    â”‚ â”‚  Bin    â”‚   â”‚            â”‚
â”‚  â”‚  â”‚Controllerâ”‚ â”‚Controllerâ”‚ â”‚Controllerâ”‚ â”‚Controllerâ”‚ â”‚            â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚            â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â”‚                                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚  â”‚ TensorFlow  â”‚    â”‚   MySQL     â”‚    â”‚   Gmail     â”‚              â”‚
â”‚  â”‚   Model     â”‚    â”‚  Database   â”‚    â”‚   SMTP      â”‚              â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
â”‚                                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.2 Thiáº¿t káº¿ pháº§n cá»©ng

#### 3.2.1 Danh sÃ¡ch linh kiá»‡n

| Linh kiá»‡n | Sá»‘ lÆ°á»£ng | ThÃ´ng sá»‘ ká»¹ thuáº­t |
|-----------|----------|-------------------|
| Arduino Uno | 1 | ATmega328P, 16MHz, 5V |
| CNC Shield V3 | 1 | Há»— trá»£ 4 driver A4988/DRV8825 |
| Stepper Motor | 3 | NEMA 17, 200 steps/rev |
| Driver A4988 | 3 | 1.5A max, Microstep |
| Limit Switch | 2 | CÃ´ng táº¯c hÃ nh trÃ¬nh |
| IR Sensor | 2 | Cáº£m biáº¿n há»“ng ngoáº¡i |
| Relay Module | 1 | 5V, 10A |
| Camera | 1 | USB Webcam |
| Van hÃºt chÃ¢n khÃ´ng | 1 | 12V DC |

#### 3.2.2 SÆ¡ Ä‘á»“ káº¿t ná»‘i

**Motor Pins (CNC Shield V3):**
- Trá»¥c X: Step(2), Dir(5)
- Trá»¥c Y: Step(3), Dir(6)
- Trá»¥c Z: Step(4), Dir(7)
- Enable: Pin 8

**Cáº£m biáº¿n vÃ  cÆ¡ cáº¥u cháº¥p hÃ nh:**
- Limit Switch Z: Pin 12
- Limit Switch X: Pin 13
- IR Sensor 1: Pin 9
- IR Sensor 2: Pin 10
- Relay (Van hÃºt): Pin 11

### 3.3 Thiáº¿t káº¿ pháº§n má»m

#### 3.3.1 Backend - Flask Server

**Cáº¥u trÃºc thÆ° má»¥c:**
```
main/
â”œâ”€â”€ app_ws.py              # Entry point vá»›i WebSocket
â”œâ”€â”€ config.py              # Cáº¥u hÃ¬nh há»‡ thá»‘ng
â”œâ”€â”€ controllers/           # Business Logic
â”‚   â”œâ”€â”€ serial_controller.py    # Giao tiáº¿p Arduino
â”‚   â”œâ”€â”€ camera_controller.py    # Äiá»u khiá»ƒn Camera
â”‚   â”œâ”€â”€ ml_controller.py        # AI/ML Predictions
â”‚   â”œâ”€â”€ bin_controller.py       # Quáº£n lÃ½ thÃ¹ng chá»©a
â”‚   â”œâ”€â”€ script_executor_ws.py   # Thá»±c thi script
â”‚   â””â”€â”€ email_controller.py     # Gá»­i email thÃ´ng bÃ¡o
â”œâ”€â”€ routes/                # API Endpoints
â””â”€â”€ templates/             # HTML Templates
```

**CÃ¡c tÃ­nh nÄƒng chÃ­nh:**
1. **WebSocket Real-time:** Cáº­p nháº­t tráº¡ng thÃ¡i liÃªn tá»¥c
2. **Script Queue System:** HÃ ng Ä‘á»£i xá»­ lÃ½ nhiá»u ká»‹ch báº£n
3. **Lazy Loading:** Tá»‘i Æ°u thá»i gian khá»Ÿi Ä‘á»™ng
4. **Cloud Sync:** Äá»“ng bá»™ dá»¯ liá»‡u lÃªn server tá»« xa

#### 3.3.2 Machine Learning Model

**Äáº·c Ä‘iá»ƒm ká»¹ thuáº­t:**
- Framework: TensorFlow SavedModel
- Input size: 224x224 RGB
- Output classes:
  1. Premium-grade watermelon (Loáº¡i 1)
  2. Second-grade watermelon (Loáº¡i 2)
  3. Defective watermelon (Lá»—i)
  4. Nothing (KhÃ´ng cÃ³ váº­t)

**Tá»‘i Æ°u hÃ³a:**
- Lazy Loading: Model chá»‰ load khi cáº§n
- Prediction Cache: Cache 0.5s trÃ¡nh inference láº·p
- Background pre-warming: Warm up model khi há»‡ thá»‘ng idle

#### 3.3.3 Mobile App - React Native

**CÃ¡c mÃ n hÃ¬nh chÃ­nh:**
| Screen | Chá»©c nÄƒng |
|--------|-----------|
| LoginScreen | ÄÄƒng nháº­p há»‡ thá»‘ng |
| ConnectScreen | Káº¿t ná»‘i vá»›i thiáº¿t bá»‹ |
| DashboardScreen | Thá»‘ng kÃª tá»•ng quan |
| HistoryScreen | Lá»‹ch sá»­ hoáº¡t Ä‘á»™ng |
| ChatbotScreen | Trá»£ lÃ½ AI |

### 3.4 Giao diá»‡n ngÆ°á»i dÃ¹ng

#### 3.4.1 Web UI - Blockly Workspace

**CÃ¡c khá»‘i lá»‡nh cÃ³ sáºµn:**

| Khá»‘i | MÃ´ táº£ | ThÃ´ng sá»‘ |
|------|-------|----------|
| ğŸŸ¡ When Run | Äiá»ƒm báº¯t Ä‘áº§u chÆ°Æ¡ng trÃ¬nh | - |
| ğŸ”µ Move Motor | Di chuyá»ƒn trá»¥c X/Y/Z | Trá»¥c, HÆ°á»›ng, Thá»i gian, Tá»‘c Ä‘á»™ |
| ğŸŸ¢ Relay Control | Báº­t/Táº¯t relay (van hÃºt) | ON/OFF |
| ğŸŸ¢ Relay Pulse | Relay ON trong N giÃ¢y | Tráº¡ng thÃ¡i, Thá»i gian |
| ğŸŸ  Wait | Táº¡m dá»«ng N giÃ¢y | Sá»‘ giÃ¢y |
| ğŸŸ£ Home Z/X | Vá» vá»‹ trÃ­ gá»‘c | - |
| ğŸ”´ Check Label | Kiá»ƒm tra nhÃ£n tá»« camera | Premium/Second/Defective |
| ğŸ”„ Repeat | Láº·p láº¡i N láº§n | Sá»‘ láº§n, CÃ¡c lá»‡nh |
| â“ If/Else | Äiá»u kiá»‡n | Äiá»u kiá»‡n, Then, Else |

**VÃ­ dá»¥ Script phÃ¢n loáº¡i:**
```
When Run
â”œâ”€â”€ Home X Axis
â”œâ”€â”€ Repeat 10 times
â”‚   â”œâ”€â”€ Move Z- 1000ms Speed 50
â”‚   â”œâ”€â”€ Relay ON for 2 seconds
â”‚   â”œâ”€â”€ Move Z+ 1000ms Speed 50
â”‚   â”œâ”€â”€ If Check Label is "Premium Watermelon"
â”‚   â”‚   â””â”€â”€ Move X+ 2000ms Speed 80
â”‚   â””â”€â”€ Else
â”‚       â””â”€â”€ Move X- 2000ms Speed 80
â””â”€â”€ Home Z Axis
```

#### 3.4.2 Chatbot AI Interface

**TÃ­nh nÄƒng:**
- Tráº£ lá»i báº±ng tiáº¿ng Viá»‡t tá»± nhiÃªn
- Hiá»ƒn thá»‹ Markdown (bold, báº£ng, danh sÃ¡ch)
- Quick Actions: Tá»“n kho, Cáº£nh bÃ¡o, Thá»‘ng kÃª
- Reasoning display: Hiá»ƒn thá»‹ quÃ¡ trÃ¬nh suy luáº­n

**Context Data tá»± Ä‘á»™ng thu tháº­p:**
- Tráº¡ng thÃ¡i tá»“n kho (bins)
- Lá»‹ch sá»­ cáº£nh bÃ¡o
- Thá»‘ng kÃª theo ngÃ y/tuáº§n/thÃ¡ng

---

## CHÆ¯Æ NG 4: TRIá»‚N KHAI VÃ€ THá»°C HIá»†N

### 4.1 Pháº§n cá»©ng Arduino vÃ  CNC Shield

#### 4.1.1 Code Arduino (main.ino)

**Khá»Ÿi táº¡o há»‡ thá»‘ng:**
```cpp
void setup() {
  Serial.begin(9600);
  
  // Setup Motor pins
  pinMode(en, OUTPUT);
  pinMode(stepPinX, OUTPUT); pinMode(dirPinX, OUTPUT);
  pinMode(stepPinY, OUTPUT); pinMode(dirPinY, OUTPUT);
  pinMode(stepPinZ, OUTPUT); pinMode(dirPinZ, OUTPUT);
  
  // Setup Input
  pinMode(Z_LIMIT_PIN, INPUT_PULLUP);
  pinMode(X_LIMIT_PIN, INPUT_PULLUP); 
  pinMode(IR_SENSOR_1, INPUT_PULLUP);
  pinMode(IR_SENSOR_2, INPUT_PULLUP);

  // Setup Relay
  pinMode(RELAY_PIN, OUTPUT);
  digitalWrite(RELAY_PIN, HIGH);

  // KÃ­ch hoáº¡t Driver
  digitalWrite(en, LOW); 
  Serial.println("READY");
}
```

**Giao thá»©c lá»‡nh Serial:**

| Lá»‡nh | Format | VÃ­ dá»¥ | MÃ´ táº£ |
|------|--------|-------|-------|
| Move | `M <X> <Y> <Z> <time> <speed>` | `M 1 0 0 1000 50` | Di chuyá»ƒn X+ trong 1s á»Ÿ 50 RPM |
| Relay | `R <state>` | `R 1` | Báº­t relay |
| Home Z | `H` | `H` | Vá» home trá»¥c Z |
| Home X | `HX` | `HX` | Vá» home trá»¥c X |
| Check | `C` | `C` | Äá»c cáº£m biáº¿n |

#### 4.1.2 HÃ m di chuyá»ƒn motor

```cpp
void moveMotors(int dirX, int dirY, int dirZ, 
                unsigned long duration, float speedRpm) {
  
  if (speedRpm <= 0) speedRpm = 50;
  long localPeriod = 1000000 / (speedRpm / 60 * pulsePerRound);

  // Set hÆ°á»›ng
  if (dirX != NO_MOVE) 
    digitalWrite(dirPinX, (dirX == X_POS ? HIGH : LOW));
  if (dirY != NO_MOVE) 
    digitalWrite(dirPinY, (dirY == Y_POS ? HIGH : LOW));
  if (dirZ != NO_MOVE) 
    digitalWrite(dirPinZ, (dirZ == Z_POS ? HIGH : LOW));

  unsigned long startTime = millis();
  
  while (millis() - startTime < duration) {
    if (dirX != NO_MOVE) digitalWrite(stepPinX, HIGH);
    if (dirY != NO_MOVE) digitalWrite(stepPinY, HIGH);
    if (dirZ != NO_MOVE) digitalWrite(stepPinZ, HIGH);
    delayMicroseconds(0.5 * localPeriod);

    if (dirX != NO_MOVE) digitalWrite(stepPinX, LOW);
    if (dirY != NO_MOVE) digitalWrite(stepPinY, LOW);
    if (dirZ != NO_MOVE) digitalWrite(stepPinZ, LOW);
    delayMicroseconds(0.5 * localPeriod);
  }
  Serial.println("DONE");
}
```

### 4.2 Backend Flask Server

#### 4.2.1 Serial Controller

```python
class SerialController:
    """Thread-safe serial communication controller"""
    
    def __init__(self):
        self.lock = threading.Lock()
        self.ser = None
        self.connect()

    def send_command(self, cmd):
        if not self.ser:
            return "Error: No Serial Connection"
        
        with self.lock:
            try:
                self.ser.write(f"{cmd}\n".encode('utf-8'))
                response = self.ser.readline().decode('utf-8').strip()
                return response
            except Exception as e:
                return f"Error: {e}"
```

#### 4.2.2 WebSocket Events

```python
@socketio.on('execute_script')
def handle_execute(data):
    script = data.get('script', [])
    priority = data.get('priority', False)
    
    if priority:
        success = executor.execute_priority(script)
    else:
        success = executor.enqueue(script)
    
    emit('script_queued', {
        'success': success,
        'queue_size': executor.queue_size()
    })

@socketio.on('get_status')
def handle_get_status():
    emit('status', {
        'serial_connected': arduino.is_connected(),
        'bins': bins.get_status(),
        'script_running': executor.is_running,
        'queue_size': executor.queue_size()
    })
```

### 4.3 Machine Learning Model

#### 4.3.1 ML Controller

```python
class MLController:
    """Machine Learning model controller with lazy loading"""
    
    def __init__(self):
        self.model_layer = None
        self.class_names = []
        self.is_loaded = False
        self._prediction_cache = {}
        self._cache_ttl = 0.5
    
    def predict_frame(self, frame):
        if not self.is_loaded:
            if not self.load_model():
                return -1, "Model Not Loaded", 0.0
        
        # Convert BGR to RGB
        image_cv = cv2.cvtColor(frame, cv2.COLOR_BGR2RGB)
        image_pil = Image.fromarray(image_cv)
        
        # Preprocess
        data = self.preprocess_image(image_pil)
        
        # Predict
        prediction_dict = self.model_layer(data)
        prediction = list(prediction_dict.values())[0]
        
        index = np.argmax(prediction)
        class_name = self.class_names[index].strip()
        confidence_score = float(prediction[0][index])
        
        return (index, class_name, confidence_score)
```

#### 4.3.2 NhÃ£n phÃ¢n loáº¡i (labels.txt)

```
0 Premium-grade watermelon
1 Second-grade watermelon
2 Defective watermelon
3 Nothing
```

### 4.4 Mobile App vá»›i Chatbot AI

#### 4.4.1 System Prompt cho Chatbot

```javascript
const SYSTEM_PROMPT = `Báº¡n lÃ  AI quáº£n lÃ½ kho thÃ´ng minh cho 
há»‡ thá»‘ng phÃ¢n loáº¡i dÆ°a háº¥u tá»± Ä‘á»™ng PDscript.

## VAI TRÃ’:
- Trá»£ lÃ½ phÃ¢n tÃ­ch dá»¯ liá»‡u kho hÃ ng
- Cung cáº¥p thÃ´ng tin tá»“n kho, cáº£nh bÃ¡o, thá»‘ng kÃª
- Tráº£ lá»i báº±ng tiáº¿ng Viá»‡t, ngáº¯n gá»n, chuyÃªn nghiá»‡p

## THUáº¬T NGá»®:
- Premium Bin: ThÃ¹ng chá»©a dÆ°a loáº¡i 1 (thÆ°á»£ng háº¡ng)
- Second-grade Bin: ThÃ¹ng chá»©a dÆ°a loáº¡i 2
- Fill %: Pháº§n trÄƒm Ä‘áº§y cá»§a thÃ¹ng
- Detection: PhÃ¡t hiá»‡n/phÃ¢n loáº¡i má»™t quáº£ dÆ°a
`;
```

#### 4.4.2 Context Data Builder

```javascript
const buildContextString = () => {
    let ctx = "";
    
    // Inventory
    ctx += `\n### Tá»’N KHO\n`;
    ctx += `- Tá»•ng: ${inv.total_items}/${inv.total_capacity}\n`;
    
    // Alerts
    ctx += `\n### Cáº¢NH BÃO\n`;
    ctx += `- ChÆ°a Ä‘á»c: ${alerts.unread_count}\n`;
    
    // Analytics
    ctx += `\n### THá»NG KÃŠ HÃ”M NAY\n`;
    ctx += `- ÄÃ£ xá»­ lÃ½: ${today.total_processed}\n`;
    
    return ctx;
};
```

---

## CHÆ¯Æ NG 5: Káº¾T QUáº¢ VÃ€ ÄÃNH GIÃ

### 5.1 Káº¿t quáº£ thá»­ nghiá»‡m

#### 5.1.1 Äá»™ chÃ­nh xÃ¡c phÃ¢n loáº¡i

| Loáº¡i dÆ°a | Sá»‘ máº«u | ÄÃºng | Sai | Äá»™ chÃ­nh xÃ¡c |
|----------|--------|------|-----|--------------|
| Premium | 100 | 95 | 5 | 95% |
| Second-grade | 100 | 92 | 8 | 92% |
| Defective | 50 | 48 | 2 | 96% |
| **Tá»•ng** | **250** | **235** | **15** | **94%** |

#### 5.1.2 Thá»i gian xá»­ lÃ½

| CÃ´ng Ä‘oáº¡n | Thá»i gian |
|-----------|-----------|
| Chá»¥p áº£nh | ~50ms |
| Inference ML | ~200ms |
| Di chuyá»ƒn robot | ~3s |
| **Tá»•ng 1 chu ká»³** | **~3.5s** |

#### 5.1.3 Tá»‘c Ä‘á»™ phÃ¢n loáº¡i

- Trung bÃ¬nh: **~15-17 quáº£/phÃºt**
- TÆ°Æ¡ng Ä‘Æ°Æ¡ng: **~900-1000 quáº£/giá»**

### 5.2 ÄÃ¡nh giÃ¡ hiá»‡u nÄƒng

#### 5.2.1 WebSocket Response Time

| Event | Latency |
|-------|---------|
| script_started | <10ms |
| script_progress | <5ms |
| prediction | <50ms |

#### 5.2.2 Chatbot AI Performance

| Metric | GiÃ¡ trá»‹ |
|--------|---------|
| Response time | 1-3s |
| Context refresh | 30s/láº§n |
| Accuracy | Cao vá»›i dá»¯ liá»‡u cung cáº¥p |

### 5.3 Æ¯u Ä‘iá»ƒm vÃ  háº¡n cháº¿

#### 5.3.1 Æ¯u Ä‘iá»ƒm

**So vá»›i cÃ¡c sáº£n pháº©m hiá»‡n cÃ³:**
1. **Giao diá»‡n thÃ¢n thiá»‡n:** Blockly cho phÃ©p láº­p trÃ¬nh khÃ´ng cáº§n code
2. **Chatbot AI:** Chuyá»ƒn Ä‘á»•i dá»¯ liá»‡u ká»¹ thuáº­t thÃ nh ngÃ´n ngá»¯ tá»± nhiÃªn
3. **Real-time monitoring:** WebSocket cáº­p nháº­t tráº¡ng thÃ¡i liÃªn tá»¥c
4. **Mobile app:** GiÃ¡m sÃ¡t tá»« xa qua Ä‘iá»‡n thoáº¡i
5. **Chi phÃ­ tháº¥p:** Sá»­ dá»¥ng Arduino vÃ  linh kiá»‡n phá»• biáº¿n

**TÃ­nh á»•n Ä‘á»‹nh vÃ  Ä‘á»™ tin cáº­y:**
- Thread-safe serial communication
- Queue system vá»›i priority handling
- Lazy loading tá»‘i Æ°u tÃ i nguyÃªn
- Error handling vÃ  recovery

**TÃ­nh má»›i, sÃ¡ng táº¡o:**
- Káº¿t há»£p 3 cÃ´ng nghá»‡: Robot + CV + AI Chatbot
- Visual programming cho robot nÃ´ng nghiá»‡p
- Chatbot vá»›i context-aware tá»« dá»¯ liá»‡u thá»±c

#### 5.3.2 Háº¡n cháº¿

1. **Äiá»u kiá»‡n Ã¡nh sÃ¡ng:** Model nháº¡y cáº£m vá»›i thay Ä‘á»•i Ã¡nh sÃ¡ng
2. **Tá»‘c Ä‘á»™:** CÃ²n cháº­m so vá»›i dÃ¢y chuyá»n cÃ´ng nghiá»‡p
3. **KÃ­ch thÆ°á»›c dÆ°a:** ChÆ°a xá»­ lÃ½ Ä‘a dáº¡ng kÃ­ch thÆ°á»›c
4. **Káº¿t ná»‘i Serial:** Phá»¥ thuá»™c vÃ o cÃ¡p USB, chÆ°a cÃ³ wireless

---

## CHÆ¯Æ NG 6: Káº¾T LUáº¬N VÃ€ HÆ¯á»šNG PHÃT TRIá»‚N

### 6.1 Káº¿t luáº­n

Äá» tÃ i "Há»‡ thá»‘ng phÃ¢n loáº¡i dÆ°a háº¥u sá»­ dá»¥ng cÃ¡nh tay robot tÃ­ch há»£p Thá»‹ giÃ¡c mÃ¡y tÃ­nh vÃ  Chatbot AI" Ä‘Ã£ hoÃ n thÃ nh cÃ¡c má»¥c tiÃªu Ä‘á» ra:

**âœ“ Vá» ká»¹ thuáº­t:**
- XÃ¢y dá»±ng thÃ nh cÃ´ng há»‡ thá»‘ng CNC 3 trá»¥c Ä‘iá»u khiá»ƒn báº±ng Arduino
- TÃ­ch há»£p model Machine Learning phÃ¢n loáº¡i dÆ°a háº¥u vá»›i Ä‘á»™ chÃ­nh xÃ¡c 94%
- PhÃ¡t triá»ƒn backend Flask Server vá»›i WebSocket real-time

**âœ“ Vá» tÆ°Æ¡ng tÃ¡c ngÆ°á»i-mÃ¡y:**
- Giao diá»‡n Blockly cho phÃ©p láº­p trÃ¬nh kÃ©o tháº£ trá»±c quan
- Chatbot AI cung cáº¥p thÃ´ng tin báº±ng ngÃ´n ngá»¯ tá»± nhiÃªn tiáº¿ng Viá»‡t
- Mobile app giÃ¡m sÃ¡t tá»« xa vá»›i dashboard thá»‘ng kÃª

**âœ“ Vá» á»©ng dá»¥ng thá»±c tiá»…n:**
- Giáº£i quyáº¿t bÃ i toÃ¡n phÃ¢n loáº¡i thá»§ cÃ´ng cá»§a nÃ´ng sáº£n Viá»‡t Nam
- Chi phÃ­ Ä‘áº§u tÆ° há»£p lÃ½ vá»›i quy mÃ´ nÃ´ng há»™
- Dá»… sá»­ dá»¥ng, khÃ´ng yÃªu cáº§u kiáº¿n thá»©c láº­p trÃ¬nh

### 6.2 HÆ°á»›ng phÃ¡t triá»ƒn

**Ngáº¯n háº¡n:**
1. Cáº£i thiá»‡n model ML vá»›i dataset lá»›n hÆ¡n
2. ThÃªm tÃ­nh nÄƒng Ä‘o kÃ­ch thÆ°á»›c dÆ°a báº±ng computer vision
3. TÃ­ch há»£p cÃ¢n Ä‘iá»‡n tá»­ Ä‘á»ƒ phÃ¢n loáº¡i theo khá»‘i lÆ°á»£ng

**Trung háº¡n:**
1. Thay tháº¿ Arduino báº±ng ESP32 Ä‘á»ƒ cÃ³ WiFi/Bluetooth
2. PhÃ¡t triá»ƒn phiÃªn báº£n vá»›i nhiá»u trá»¥c hÆ¡n (4-6 DOF)
3. TÃ­ch há»£p há»‡ thá»‘ng bÄƒng chuyá»n tá»± Ä‘á»™ng

**DÃ i háº¡n:**
1. NhÃ¢n rá»™ng cho cÃ¡c loáº¡i nÃ´ng sáº£n khÃ¡c (bÆ°á»Ÿi, cam, xoÃ i...)
2. PhÃ¡t triá»ƒn thÃ nh sáº£n pháº©m thÆ°Æ¡ng máº¡i
3. TÃ­ch há»£p vá»›i há»‡ thá»‘ng quáº£n lÃ½ nÃ´ng tráº¡i thÃ´ng minh (Smart Farm)

---

## TÃ€I LIá»†U THAM KHáº¢O

[1] RSIP Vision. (n.d.). *Robots using Machine Vision in Agriculture*. https://www.rsipvision.com/robots-using-machine-vision-agriculture/

[2] Rybacki, P. et al. (2024). *Convolutional Neural Network (CNN) Model for the Classification of Varieties of Date Palm Fruits*. Sensors, 24(2), 558.

[3] Google. (n.d.). *Blockly - A visual programming editor*. https://developers.google.com/blockly

[4] TensorFlow. (n.d.). *TensorFlow SavedModel*. https://www.tensorflow.org/guide/saved_model

[5] Flask-SocketIO. (n.d.). *Flask-SocketIO documentation*. https://flask-socketio.readthedocs.io/

[6] Arduino. (n.d.). *Arduino Uno Rev3*. https://www.arduino.cc/en/Main/ArduinoBoardUno

[7] CNC Shield V3 Documentation. https://blog.protoneer.co.nz/arduino-cnc-shield/

[8] React Native. (n.d.). *React Native documentation*. https://reactnative.dev/

[9] ivySCI. (2023). *Development of watermelon picking robot based on AioT*. https://www.ivysci.com/en/articles/10970472

[10] Last Minute Engineers. (n.d.). *Joystick and Servo Motor control*. https://lastminuteengineers.com

---

## PHá»¤ Lá»¤C

### Phá»¥ lá»¥c A: Cáº¥u hÃ¬nh há»‡ thá»‘ng (config.py)

```python
# ================= PATHS =================
MODEL_PATH = "../model.savedmodel"
LABELS_PATH = "../labels.txt"

# ================= SERIAL =================
SERIAL_PORT = "COM5"
BAUD_RATE = 9600
SERIAL_TIMEOUT = 1

# ================= CAMERA =================
CAMERA_INDEX = 1
CAMERA_FALLBACK_INDEX = 0

# ================= SERVER =================
SERVER_HOST = '0.0.0.0'
SERVER_PORT = 5000

# ================= BIN DETECTION =================
BIN_CHECK_SAMPLES = 30
BIN_CHECK_INTERVAL = 0.1
BIN_FULL_THRESHOLD = 0.9

# ================= ML MODEL =================
IMAGE_SIZE = (224, 224)
```

### Phá»¥ lá»¥c B: REST API Endpoints

| Method | Endpoint | MÃ´ táº£ |
|--------|----------|-------|
| POST | /api/control | Gá»­i lá»‡nh thá»§ cÃ´ng |
| GET | /api/sensors | Äá»c cáº£m biáº¿n IR |
| GET | /api/bin_status | Tráº¡ng thÃ¡i thÃ¹ng chá»©a |
| POST | /api/reset_bins | Reset cá» thÃ¹ng Ä‘áº§y |
| POST | /api/execute_script | Thá»±c thi script |
| POST | /api/stop_script | Dá»«ng script |
| GET | /api/status | Tráº¡ng thÃ¡i há»‡ thá»‘ng |
| GET | /api/history | Lá»‹ch sá»­ hoáº¡t Ä‘á»™ng |
| GET | /api/history/stats | Thá»‘ng kÃª |
| GET | /api/email/config | Cáº¥u hÃ¬nh email |
| POST | /api/email/test | Gá»­i email test |

### Phá»¥ lá»¥c C: HÆ°á»›ng dáº«n cÃ i Ä‘áº·t

**1. CÃ i Ä‘áº·t Dependencies:**
```powershell
cd main
pip install -r requirements.txt
```

**2. Upload code Arduino:**
- Má»Ÿ Arduino IDE
- Upload `arduino_main/main.ino` lÃªn Arduino Uno
- Ghi nhá»› cá»•ng COM

**3. Cháº¡y Server:**
```powershell
python app_ws.py
```

**4. Truy cáº­p:**
- Web UI: http://localhost:5000
- Táº¡o script vá»›i Blockly
- Nháº¥n **Run** Ä‘á»ƒ thá»±c thi

---

**Â© 2024 NhÃ³m NgÅ© Lá»±c BÃ¡ch Khoa - TrÆ°á»ng Äáº¡i há»c BÃ¡ch Khoa TP.HCM**
